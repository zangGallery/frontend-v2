import{r as e,a1 as P,ae as G}from"./web3-core-DPDfnnte.js";import{a as b}from"./react-vendor-z79Uuty_.js";import{b as O,d as D,r as _,s as L,e as J,f as Y,H as q,S as K,c as R,g as Q,R as X,V as Z,v as ee}from"./index-CTMr4hGG.js";import{u as te,V as m,n as se,D as ne,g as re}from"./decimal-BsKyFVDe.js";import{R as ie}from"./ui-vendor-51-FR4Jz.js";import{E as ae}from"./md-editor-2-khWZ_d.js";import{n as oe}from"./rainbowkit-BIkuclrH.js";function le({isOpen:n,setIsOpen:s,onClose:i}){const r=a=>{s(!1),i(a)};return n?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:()=>r(!1)}),e.jsxs("div",{className:"relative bg-ink-900 border border-ink-700 rounded-xl shadow-2xl max-w-md w-full mx-4 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-5 border-b border-ink-800",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-amber-500/10 border border-amber-500/20",children:e.jsx("svg",{className:"w-5 h-5 text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Some fields are empty"}),e.jsx("p",{className:"text-sm text-ink-400",children:"Are you sure you want to mint anyway?"})]})]})}),e.jsxs("div",{className:"px-6 py-4 bg-ink-900/50 flex items-center justify-end gap-3",children:[e.jsx("button",{className:"px-4 py-2 text-ink-300 hover:text-white transition-colors",onClick:()=>r(!1),children:"Cancel"}),e.jsx("button",{className:"px-4 py-2 bg-white text-ink-950 font-medium rounded-lg hover:bg-ink-100 transition-colors",onClick:()=>r(!0),children:"Mint Anyway"})]})]})]}):null}function ce({textType:n,value:s,setValue:i}){switch(n){case"text/markdown":return e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"rounded-lg overflow-hidden border border-ink-700","data-color-mode":"dark",children:e.jsx(ae,{value:s,onChange:i,highlightEnable:!1,previewOptions:{rehypePlugins:[()=>_(L.validMarkdown)]},commands:D,height:400})}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-ink-900/50 rounded-lg border border-ink-800",children:[e.jsx("span",{className:"text-purple-400 text-lg",children:"#"}),e.jsxs("p",{className:"text-sm text-ink-400",children:["Need help with Markdown? Check the"," ",e.jsx("a",{className:"text-purple-400 hover:text-purple-300 underline",target:"_blank",rel:"noopener noreferrer",href:"https://docs.github.com/en/github/writing-on-github/getting-started-with-writing-and-formatting-on-github/basic-writing-and-formatting-syntax",children:"GitHub Markdown guide"})]})]})]});case"text/plain":return e.jsx("textarea",{className:"w-full h-[400px] px-4 py-3 bg-ink-900 border border-ink-700 rounded-lg text-ink-100 font-mono text-sm placeholder-ink-500 resize-none focus:outline-none focus:border-accent-cyan focus:ring-1 focus:ring-accent-cyan transition-colors",value:s,onChange:r=>i(r.target.value),placeholder:"Start writing your text..."});case"text/html":return e.jsxs("div",{className:"space-y-3",children:[e.jsx(O,{value:s,setValue:i}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-ink-900/50 rounded-lg border border-ink-800",children:[e.jsx("span",{className:"text-amber-400 font-mono text-sm",children:"</>"}),e.jsx("p",{className:"text-sm text-ink-400",children:"HTML + CSS + SVG supported. Scripts and event handlers are sanitized for security."})]})]});default:return e.jsx("p",{className:"text-ink-400",children:"Unsupported editor type"})}}const N={editionSize:1,royaltyPercentage:10,useCustomRecipient:!1,textType:"text/plain"};function de({value:n,label:s,icon:i,description:r,selected:a,onClick:f,color:u}){const h={blue:{border:"border-blue-500",bg:"bg-blue-500/10",icon:"text-blue-400"},purple:{border:"border-purple-500",bg:"bg-purple-500/10",icon:"text-purple-400"},amber:{border:"border-amber-500",bg:"bg-amber-500/10",icon:"text-amber-400"}},c=h[u]||h.blue;return e.jsxs("button",{type:"button",onClick:f,className:`flex-1 p-4 rounded-xl border-2 transition-all duration-200 text-left ${a?`${c.border} ${c.bg}`:"border-ink-700 bg-ink-900/50 hover:border-ink-500 hover:bg-ink-900"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:`text-2xl w-8 text-center ${a?c.icon:"text-ink-500"}`,children:i}),e.jsx("span",{className:`font-medium ${a?"text-white":"text-ink-300"}`,children:s})]}),e.jsx("p",{className:`text-sm ${a?"text-ink-300":"text-ink-500"}`,children:r})]})}function ke(){const{register:n,formState:{errors:s,isValid:i},handleSubmit:r,watch:a,setValue:f}=te({defaultValues:N,mode:"onChange",resolver:se(L.mint)}),[u,h]=b.useState(""),{isConnected:c,address:A}=P(),{writeContractAsync:E}=G(),[v]=b.useState({status:"noTransaction"}),[w,C]=b.useState(!1),[g,z]=b.useState(!1),F=a("useCustomRecipient",N.useCustomRecipient),j=a("textType",N.textType),H=J(),[,x]=ie(Y),I=R.contractAddresses.v1.zang,S=o=>async t=>{if(!c){x("Please connect a wallet.");return}if(t={...t,text:u},!(t.title&&t.description&&t.text)&&!o){w||C(!0);return}const U=()=>[...t.text].some(l=>l.charCodeAt(0)>127);x(null);const V="data:"+t.textType+(U()&&t.textType==="text/plain"?",charset=UTF-8":"")+","+encodeURIComponent(t.text),W=new ne(t.royaltyPercentage).mul("100").toNumber();let d=null;if(t.useCustomRecipient){if(d=t.customRecipient,d.includes(".eth")){let l=null;try{l=await Q.getEnsAddress({name:oe(d)})}catch(k){x('Invalid custom recipient address: "'+k.message+'".');return}if(l)d=l;else{x("Could not resolve ENS name.");return}}}else d=A;H(async()=>await E({address:I,abi:ee.zang,functionName:"mint",args:[V,t.title||"",t.description||"",BigInt(t.editionSize),BigInt(W),d,0n],...re()}),"Mint",async(l,k,$,y)=>{var T;if(l!=="success")return null;if($&&y&&y.blockNumber){const M=(T=y.logs)==null?void 0:T.find(p=>{try{return p.topics[0]==="0xc3d58168c5ae7397731d063d5bbf3d657854427343f4c083240f7aacaa2d0f62"}catch{return!1}});if(M){const p=BigInt(M.topics[3]).toString();return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsxs(X,{className:"text-accent-cyan hover:underline",href:"/nft?id="+p,children:["NFT #",p]})," ","minted successfully!"]}),e.jsx("p",{children:e.jsx(Z,{hash:k.hash})})]})}else{x("Could not find token ID in transaction receipt.");return}}})},B=[{value:"text/plain",label:"Plain Text",icon:"¶",description:"Simple text, poetry, prose",color:"blue"},{value:"text/markdown",label:"Markdown",icon:"#",description:"Formatted text with styling",color:"purple"},{value:"text/html",label:"HTML",icon:"<>",description:"Rich content with CSS",color:"amber"}];return e.jsxs("div",{className:"min-h-screen bg-ink-950",children:[e.jsx(q,{}),e.jsx(K,{}),e.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("p",{className:"text-ink-500 font-mono text-sm mb-3",children:"$ create new"}),e.jsx("h1",{className:"text-3xl sm:text-4xl font-mono text-white mb-4",children:"Mint Your Work"}),e.jsx("p",{className:"text-ink-400 max-w-lg mx-auto",children:"Turn your text into a permanent, collectible NFT on Base."})]}),e.jsxs("form",{onSubmit:r(S(!1)),className:"space-y-8",children:[e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-ink-800 text-ink-400 text-sm font-mono",children:"1"}),e.jsx("h2",{className:"text-lg font-medium text-ink-200",children:"Choose your medium"})]}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-3",children:B.map(o=>e.jsx(de,{...o,selected:j===o.value,onClick:()=>f("textType",o.value)},o.value))}),e.jsx("input",{type:"hidden",...n("textType")}),j==="text/html"&&e.jsxs("div",{className:"p-4 bg-ink-900/70 rounded-lg border border-ink-700 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-400",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"font-medium text-sm",children:"HTML Content Guidelines"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-xs",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-400 font-medium mb-1.5",children:"Allowed"}),e.jsxs("ul",{className:"text-ink-400 space-y-1",children:[e.jsx("li",{children:"• All HTML elements (div, span, p, etc.)"}),e.jsx("li",{children:"• SVG graphics (svg, path, rect, circle...)"}),e.jsx("li",{children:"• CSS styles and animations"}),e.jsx("li",{children:"• Images with https:// or data: URLs"}),e.jsx("li",{children:"• Custom fonts via @import"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-red-400 font-medium mb-1.5",children:"Not Allowed"}),e.jsxs("ul",{className:"text-ink-400 space-y-1",children:[e.jsx("li",{children:"• JavaScript (script tags)"}),e.jsx("li",{children:"• Event handlers (onclick, onerror...)"}),e.jsx("li",{children:"• Forms and inputs"}),e.jsx("li",{children:"• Iframes and embeds"}),e.jsx("li",{children:"• External links (javascript: URLs)"})]})]})]}),e.jsx("p",{className:"text-ink-500 text-xs",children:"Content is sanitized for security. CSS animations work without JavaScript."})]})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-ink-800 text-ink-400 text-sm font-mono",children:"2"}),e.jsx("h2",{className:"text-lg font-medium text-ink-200",children:"Write your content"})]}),e.jsx(ce,{textType:j,value:u,setValue:h})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-ink-800 text-ink-400 text-sm font-mono",children:"3"}),e.jsx("h2",{className:"text-lg font-medium text-ink-200",children:"Add details"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[e.jsx("div",{className:"sm:col-span-2",children:e.jsx(m,{label:"Title",name:"title",type:"text",placeholder:"Give your work a name",register:n,errors:s})}),e.jsx("div",{className:"sm:col-span-2",children:e.jsx(m,{label:"Description",name:"description",type:"text",placeholder:"What's it about? (optional)",register:n,errors:s})}),e.jsx(m,{label:"Edition Size",name:"editionSize",type:"number",hint:"How many copies to mint",register:n,errors:s}),e.jsx(m,{label:"Royalty %",name:"royaltyPercentage",type:"number",hint:"You earn this on secondary sales",register:n,errors:s})]}),e.jsxs("div",{className:"pt-4",children:[e.jsxs("button",{type:"button",onClick:()=>z(!g),className:"flex items-center gap-2 text-sm text-ink-500 hover:text-ink-300 transition-colors",children:[e.jsx("svg",{className:`w-4 h-4 transition-transform ${g?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),"Advanced options"]}),g&&e.jsxs("div",{className:"mt-4 p-4 bg-ink-900/50 rounded-lg border border-ink-800 space-y-4",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",...n("useCustomRecipient"),className:"w-4 h-4 rounded border-ink-600 bg-ink-800 text-accent-cyan focus:ring-accent-cyan focus:ring-offset-ink-900"}),e.jsx("span",{className:"text-sm text-ink-300",children:"Use custom royalty recipient"})]}),F&&e.jsx(m,{label:"Recipient Address",name:"customRecipient",type:"text",placeholder:"0x... or ENS name",register:n,errors:s})]})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-amber-500/10 border border-amber-500/20 rounded-lg",children:[e.jsx("svg",{className:"w-5 h-5 text-amber-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("p",{className:"text-sm text-amber-200/80",children:["This will create a transaction on"," ",e.jsx("strong",{className:"text-amber-200",children:R.networks.main.name}),". Make sure your wallet is connected to the right network."]})]}),e.jsx("div",{className:"pt-4",children:c?v.status==="noTransaction"||v.status==="error"?e.jsxs("button",{type:"submit",disabled:!i,className:"w-full py-4 px-6 bg-white text-ink-950 font-medium rounded-lg hover:bg-ink-100 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3",children:[e.jsx("span",{className:"font-mono text-ink-500",children:"$"}),"Mint NFT",e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]}):null:e.jsxs("div",{className:"text-center p-6 bg-ink-900/50 rounded-lg border border-ink-800",children:[e.jsx("p",{className:"text-ink-400 mb-4",children:"Connect your wallet to mint"}),e.jsx("p",{className:"text-ink-600 text-sm",children:"Use the button in the header to connect"})]})})]}),e.jsx(le,{isOpen:w,setIsOpen:C,onClose:o=>r(S(o))()})]})]})}export{ke as default};
