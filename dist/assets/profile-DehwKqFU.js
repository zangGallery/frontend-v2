import{a1 as re,a4 as ie,ad as le,ac as oe,r as e}from"./web3-core-DPDfnnte.js";import{u as ce,a as i}from"./react-vendor-z79Uuty_.js";import{u as de,a as me,m as xe,H as he,c as q,N as ue}from"./index-CTMr4hGG.js";import{S as d}from"./ui-vendor-51-FR4Jz.js";import"./md-editor-2-khWZ_d.js";import{C as ge}from"./rainbowkit-BIkuclrH.js";function fe(){var M,T,A,W,V,J;const D=ce(),n=(M=new URLSearchParams(D.search).get("address"))==null?void 0:M.toLowerCase(),{address:x}=re(),h=(x==null?void 0:x.toLowerCase())===n,{data:C}=ie({address:h?x:void 0,chainId:q.networks.main.chainId}),U=C?parseFloat(le(C.value)).toFixed(4):null,{lookupEns:v}=de(),{invalidateProfile:X}=me(),[a,Y]=i.useState(null),[s,S]=i.useState(null),[u,g]=i.useState(!0),[L,p]=i.useState(null),[b,P]=i.useState("created"),[Z,E]=i.useState(!1),[j,k]=i.useState(!1),[r,c]=i.useState({name:"",bio:"",xUsername:"",instagramUsername:"",baseUsername:""}),[B,z]=i.useState(!1),[_,N]=i.useState(null),[G,K]=i.useState(()=>{try{return localStorage.getItem("profileSetupDismissed")==="true"}catch{return!1}}),Q=()=>{K(!0);try{localStorage.setItem("profileSetupDismissed","true")}catch{}},I=!(s!=null&&s.name)&&!(s!=null&&s.bio)&&!(s!=null&&s.xUsername)&&!(s!=null&&s.instagramUsername)&&!(s!=null&&s.baseUsername),H=h&&I&&!G&&!j&&!u,{signMessageAsync:ee}=oe(),$=n?xe(n):null;i.useEffect(()=>{if(!n){p("No address provided"),g(!1);return}if(!/^0x[a-fA-F0-9]{40}$/.test(n)){p("Invalid address format"),g(!1);return}(async()=>{g(!0),p(null);try{const[l,m]=await Promise.all([fetch(`/api/author/${n}`),fetch(`/api/profile/${n}`)]);if(!l.ok)throw new Error("Failed to fetch profile");const y=await l.json();if(Y(y),m.ok){const o=await m.json();S(o),c({name:o.name||"",bio:o.bio||"",xUsername:o.xUsername||"",instagramUsername:o.instagramUsername||"",baseUsername:o.baseUsername||""})}}catch(l){p(l.message)}finally{g(!1)}})()},[n]),i.useEffect(()=>{const t=s==null?void 0:s.name,l=v(n),m=t||l||w(n);document.title=m?`${m} - zang`:"Profile - zang"},[n,v,s]);const w=t=>t?`${t.slice(0,6)}...${t.slice(-4)}`:"",se=()=>{navigator.clipboard.writeText(n),E(!0),setTimeout(()=>E(!1),2e3)},te=async()=>{z(!0),N(null);try{const t=Date.now(),l={name:r.name.trim().slice(0,50)||null,bio:r.bio.trim().slice(0,160)||null,xUsername:r.xUsername.trim().replace(/^@/,"").slice(0,50)||null,instagramUsername:r.instagramUsername.trim().replace(/^@/,"").slice(0,50)||null,baseUsername:r.baseUsername.trim().slice(0,50)||null},y=`Update my zang profile:

${JSON.stringify(l)}

Timestamp: ${t}`,o=await ee({message:y}),O=await fetch("/api/profile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({address:x,...l,signature:o,timestamp:t})}),R=await O.json();if(!O.ok)throw new Error(R.error||"Failed to save profile");S(R),k(!1),X(n)}catch(t){N(t.message||"Failed to save profile")}finally{z(!1)}},f=n?v(n):null,ae=(s==null?void 0:s.name)||f||w(n),F=b==="created"?(a==null?void 0:a.created)||[]:(a==null?void 0:a.collected)||[],ne=t=>({token_id:t.token_id,name:t.name,description:t.description,author:t.author,content_type:t.content_type,content:t.content,_stats:{totalSupply:t.total_supply?parseInt(t.total_supply,10):null,floorPrice:t.floor_price,listedCount:t.listed_count||0,totalVolume:t.total_volume||"0"}});return e.jsxs("div",{className:"min-h-screen bg-ink-950",children:[e.jsx(he,{}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:L?e.jsx("div",{className:"text-center py-16",children:e.jsxs("div",{className:"inline-block p-8 rounded-2xl bg-ink-900/50 border border-ink-800",children:[e.jsx("p",{className:"text-red-400 text-lg mb-4",children:L}),e.jsx("a",{href:"/",className:"inline-flex items-center px-6 py-3 bg-accent-cyan text-ink-950 font-medium rounded-lg hover:bg-accent-cyan/90 transition-colors",children:"Back to Home"})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-ink-900/50 rounded-2xl border border-ink-800 p-6 mb-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start gap-6",children:[$?e.jsx("img",{src:$,alt:"Avatar",className:"w-20 h-20 rounded-xl flex-shrink-0"}):e.jsx(d,{width:80,height:80,className:"rounded-xl",baseColor:"#27272a",highlightColor:"#3f3f46"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-white font-mono truncate",children:ae||e.jsx(d,{width:200,baseColor:"#27272a",highlightColor:"#3f3f46"})}),h&&!j&&!H&&e.jsxs("button",{onClick:()=>k(!0),className:"flex items-center gap-1.5 px-2.5 py-1 rounded-lg bg-ink-800 text-ink-400 hover:text-white hover:bg-ink-700 transition-colors text-sm",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),"Edit"]})]}),f&&(s==null?void 0:s.name)&&e.jsx("p",{className:"text-ink-400 font-mono text-sm mb-2",children:f}),H&&e.jsxs("div",{className:"flex items-center gap-3 mb-3 p-3 bg-ink-800/50 rounded-lg border border-ink-700",children:[e.jsx("p",{className:"text-ink-300 text-sm flex-1",children:"Add a display name, bio, and social links to personalize your profile."}),e.jsx("button",{onClick:()=>k(!0),className:"px-3 py-1.5 bg-accent-cyan text-ink-950 font-medium rounded-lg hover:bg-accent-cyan/90 transition-colors text-sm whitespace-nowrap",children:"Set up profile"}),e.jsx("button",{onClick:Q,className:"p-1.5 text-ink-500 hover:text-ink-300 transition-colors",title:"Dismiss",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(s==null?void 0:s.bio)&&e.jsx("p",{className:"text-ink-300 text-sm mb-3 max-w-xl",children:s.bio}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("button",{onClick:se,className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-ink-800 text-ink-300 hover:text-white hover:bg-ink-700 transition-colors text-sm",children:Z?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Copied"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),e.jsx("span",{className:"font-mono",children:w(n)})]})}),e.jsxs("a",{href:`${q.blockExplorer.url}/address/${n}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-ink-800 text-ink-300 hover:text-white hover:bg-ink-700 transition-colors text-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"Basescan"]}),h&&e.jsx(ge.Custom,{children:({openAccountModal:t})=>e.jsxs("button",{onClick:t,className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-ink-800 text-ink-300 hover:text-white hover:bg-ink-700 transition-colors text-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),"Wallet"]})}),(s==null?void 0:s.xUsername)&&e.jsxs("a",{href:`https://x.com/${s.xUsername}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-ink-800 text-ink-300 hover:text-white hover:bg-ink-700 transition-colors text-sm",children:[e.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),"@",s.xUsername]}),(s==null?void 0:s.instagramUsername)&&e.jsxs("a",{href:`https://instagram.com/${s.instagramUsername}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-ink-800 text-ink-300 hover:text-white hover:bg-ink-700 transition-colors text-sm",children:[e.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"})}),"@",s.instagramUsername]}),(s==null?void 0:s.baseUsername)&&e.jsxs("a",{href:`https://www.base.app/profile/${s.baseUsername}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-ink-800 text-ink-300 hover:text-white hover:bg-ink-700 transition-colors text-sm",children:[e.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 1280 1280",fill:"currentColor",children:e.jsx("path",{d:"M0,101.12c0-34.64,0-51.95,6.53-65.28,6.25-12.76,16.56-23.07,29.32-29.32C49.17,0,66.48,0,101.12,0h1077.76c34.63,0,51.96,0,65.28,6.53,12.75,6.25,23.06,16.56,29.32,29.32,6.52,13.32,6.52,30.64,6.52,65.28v1077.76c0,34.63,0,51.96-6.52,65.28-6.26,12.75-16.57,23.06-29.32,29.32-13.32,6.52-30.65,6.52-65.28,6.52H101.12c-34.64,0-51.95,0-65.28-6.52-12.76-6.26-23.07-16.57-29.32-29.32-6.53-13.32-6.53-30.65-6.53-65.28V101.12Z"})}),s.baseUsername]})]})]}),e.jsxs("div",{className:"flex gap-6 text-center",children:[h&&U&&e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold text-white font-mono",children:[U," ",e.jsx("span",{className:"text-ink-400 text-base font-sans",children:"ETH"})]}),e.jsx("div",{className:"text-xs text-ink-400 uppercase tracking-wide",children:"Balance"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white font-mono",children:u?e.jsx(d,{width:40,baseColor:"#27272a",highlightColor:"#3f3f46"}):((T=a==null?void 0:a.stats)==null?void 0:T.totalCreated)||0}),e.jsx("div",{className:"text-xs text-ink-400 uppercase tracking-wide",children:"Created"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white font-mono",children:u?e.jsx(d,{width:40,baseColor:"#27272a",highlightColor:"#3f3f46"}):((A=a==null?void 0:a.stats)==null?void 0:A.totalCollected)||0}),e.jsx("div",{className:"text-xs text-ink-400 uppercase tracking-wide",children:"Collected"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-white font-mono",children:u?e.jsx(d,{width:60,baseColor:"#27272a",highlightColor:"#3f3f46"}):e.jsxs(e.Fragment,{children:[((W=a==null?void 0:a.stats)==null?void 0:W.totalVolume)||"0"," ",e.jsx("span",{className:"text-ink-400 text-base font-sans",children:"ETH"})]})}),e.jsx("div",{className:"text-xs text-ink-400 uppercase tracking-wide",children:"Volume"})]})]})]}),j&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-ink-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Edit Profile"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 max-w-2xl",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-ink-400 mb-1",children:"Display Name"}),e.jsx("input",{type:"text",value:r.name,onChange:t=>c({...r,name:t.target.value}),maxLength:50,placeholder:"Your display name",className:"w-full px-3 py-2 bg-ink-800 border border-ink-700 rounded-lg text-white placeholder-ink-500 focus:outline-none focus:border-accent-cyan"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-ink-400 mb-1",children:"X (Twitter)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-ink-500",children:"@"}),e.jsx("input",{type:"text",value:r.xUsername,onChange:t=>c({...r,xUsername:t.target.value.replace(/^@/,"")}),maxLength:50,placeholder:"username",className:"w-full pl-7 pr-3 py-2 bg-ink-800 border border-ink-700 rounded-lg text-white placeholder-ink-500 focus:outline-none focus:border-accent-cyan"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm text-ink-400 mb-1",children:"Bio"}),e.jsx("textarea",{value:r.bio,onChange:t=>c({...r,bio:t.target.value}),maxLength:160,rows:2,placeholder:"A short bio about yourself",className:"w-full px-3 py-2 bg-ink-800 border border-ink-700 rounded-lg text-white placeholder-ink-500 focus:outline-none focus:border-accent-cyan resize-none"}),e.jsxs("p",{className:"text-xs text-ink-500 mt-1",children:[r.bio.length,"/160"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-ink-400 mb-1",children:"Instagram"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-ink-500",children:"@"}),e.jsx("input",{type:"text",value:r.instagramUsername,onChange:t=>c({...r,instagramUsername:t.target.value.replace(/^@/,"")}),maxLength:50,placeholder:"username",className:"w-full pl-7 pr-3 py-2 bg-ink-800 border border-ink-700 rounded-lg text-white placeholder-ink-500 focus:outline-none focus:border-accent-cyan"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-ink-400 mb-1",children:"Base Profile"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-ink-500 text-sm",children:"base.app/profile/"}),e.jsx("input",{type:"text",value:r.baseUsername,onChange:t=>c({...r,baseUsername:t.target.value}),maxLength:50,placeholder:"username",className:"w-full pl-32 pr-3 py-2 bg-ink-800 border border-ink-700 rounded-lg text-white placeholder-ink-500 focus:outline-none focus:border-accent-cyan"})]})]})]}),_&&e.jsx("p",{className:"text-red-400 text-sm mt-3",children:_}),e.jsxs("div",{className:"flex items-center gap-3 mt-4",children:[e.jsx("button",{onClick:te,disabled:B,className:"px-4 py-2 bg-accent-cyan text-ink-950 font-medium rounded-lg hover:bg-accent-cyan/90 transition-colors disabled:opacity-50",children:B?"Signing...":"Save Profile"}),e.jsx("button",{onClick:()=>{k(!1),N(null),c({name:(s==null?void 0:s.name)||"",bio:(s==null?void 0:s.bio)||"",xUsername:(s==null?void 0:s.xUsername)||"",instagramUsername:(s==null?void 0:s.instagramUsername)||"",baseUsername:(s==null?void 0:s.baseUsername)||""})},className:"px-4 py-2 bg-ink-800 text-ink-300 font-medium rounded-lg hover:bg-ink-700 hover:text-white transition-colors",children:"Cancel"})]}),e.jsx("p",{className:"text-xs text-ink-500 mt-2",children:"Saving requires signing a message with your wallet to verify ownership."})]})]}),e.jsxs("div",{className:"flex gap-2 mb-6",children:[e.jsxs("button",{onClick:()=>P("created"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${b==="created"?"bg-accent-cyan text-ink-950":"bg-ink-800 text-ink-300 hover:text-white hover:bg-ink-700"}`,children:["Created (",((V=a==null?void 0:a.stats)==null?void 0:V.totalCreated)||0,")"]}),e.jsxs("button",{onClick:()=>P("collected"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${b==="collected"?"bg-accent-cyan text-ink-950":"bg-ink-800 text-ink-300 hover:text-white hover:bg-ink-700"}`,children:["Collected (",((J=a==null?void 0:a.stats)==null?void 0:J.totalCollected)||0,")"]})]}),u?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(t=>e.jsxs("div",{className:"bg-ink-900/50 rounded-2xl border border-ink-800 overflow-hidden",children:[e.jsx(d,{height:208,baseColor:"#27272a",highlightColor:"#3f3f46"}),e.jsx("div",{className:"p-4",children:e.jsx(d,{count:2,baseColor:"#27272a",highlightColor:"#3f3f46"})})]},t))}):F.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:F.map(t=>e.jsx(ue,{id:t.token_id,prefetchedData:ne(t)},t.token_id))}):e.jsx("div",{className:"text-center py-16",children:e.jsx("div",{className:"inline-block p-8 rounded-2xl bg-ink-900/50 border border-ink-800",children:e.jsx("p",{className:"text-ink-400 text-lg",children:b==="created"?"No artworks created yet":"No artworks collected yet"})})})]})})]})}export{fe as default};
